<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PolymerShop Modern - Advanced E-commerce</title>
  <meta name="description" content="Modern e-commerce shopping experience with advanced animations, PWA features, and responsive design">

  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/images/polymershop-icon.svg">
  
  <!-- Theme -->
  <meta name="theme-color" content="#2196f3">
  <meta name="color-scheme" content="light dark">

  <!-- PWA Meta Tags -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="PolymerShop">
  <link rel="apple-touch-icon" href="/images/polymershop-icon.svg">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="/">
  <meta property="og:title" content="PolymerShop Modern">
  <meta property="og:description" content="Modern e-commerce shopping experience">
  <meta property="og:image" content="/images/polymershop-icon.svg">

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="/">
  <meta property="twitter:title" content="PolymerShop Modern">
  <meta property="twitter:description" content="Modern e-commerce shopping experience">
  <meta property="twitter:image" content="/images/polymershop-icon.svg">
  
  <style>
    :root {
      /* üé® Ocean Theme - Deep and soothing oceanic colors */

      /* Primary oceanic colors */
      --ocean-deep: #0a1929;        /* Very dark navy blue - deep sea */
      --ocean-dark: #0f3057;        /* Dark navy blue - depths */
      --ocean-primary: #1e5f74;     /* Ocean blue-green - surface */
      --ocean-secondary: #2c7da0;   /* Sky blue - reflected sky */
      --ocean-accent: #4dd0e1;      /* Light turquoise - reflections */
      --ocean-light: #a8dadc;       /* Pale blue-green - foam */
      --ocean-sand: #f1faee;        /* Off-white - sand */
      --ocean-white: #ffffff;       /* Pure white - waves */

      /* Oceanic gradients */
      --ocean-gradient-primary: linear-gradient(135deg, #1e5f74 0%, #2c7da0 50%, #4dd0e1 100%);
      --ocean-gradient-secondary: linear-gradient(135deg, #0f3057 0%, #1e5f74 100%);
      --ocean-gradient-accent: linear-gradient(45deg, #4dd0e1, #2c7da0);
      --ocean-gradient-surface: linear-gradient(135deg, #0a1929 0%, #0f3057 100%);

      /* Oceanic text colors */
      --text-primary: #f1faee;       /* Off-white for primary text */
      --text-secondary: #a8dadc;     /* Pale blue-green for secondary text */
      --text-muted: #6c7b95;         /* Blue-grey for muted text */
      --text-accent: #4dd0e1;        /* Turquoise for accents */

      /* Oceanic shadows */
      --shadow-ocean: 0 8px 32px rgba(14, 48, 87, 0.3);
      --shadow-ocean-light: 0 4px 16px rgba(14, 48, 87, 0.2);
      --shadow-ocean-strong: 0 12px 40px rgba(14, 48, 87, 0.4);

      /* Material Design Colors - Ocean Theme */
      --md-sys-color-primary: #1e5f74;           /* Ocean blue-green */
      --md-sys-color-on-primary: #f1faee;       /* Off-white */
      --md-sys-color-primary-container: #a8dadc; /* Pale blue-green */
      --md-sys-color-on-primary-container: #001f2a;

      --md-sys-color-secondary: #2c7da0;        /* Sky blue */
      --md-sys-color-on-secondary: #f1faee;     /* Off-white */
      --md-sys-color-secondary-container: #4dd0e1; /* Turquoise */
      --md-sys-color-on-secondary-container: #001f2a;

      --md-sys-color-surface: #0f3057;          /* Dark navy blue */
      --md-sys-color-on-surface: #f1faee;       /* Off-white */
      --md-sys-color-surface-variant: #1e5f74;   /* Ocean blue-green */
      --md-sys-color-on-surface-variant: #a8dadc; /* Pale blue-green */

      --md-sys-color-outline: #2c7da0;          /* Sky blue */
      --md-sys-color-outline-variant: #4dd0e1;   /* Turquoise */

      /* Oceanic interactive states */
      --hover-ocean: rgba(77, 208, 225, 0.1);
      --active-ocean: rgba(77, 208, 225, 0.2);
      --focus-ocean: rgba(77, 208, 225, 0.3);
      --md-sys-color-error: #ba1a1a;
      --md-sys-color-on-error: #ffffff;
      --md-sys-color-error-container: #ffdad6;
      --md-sys-color-on-error-container: #410002;
    }

    [color-scheme="dark"] {
      --md-sys-color-primary: #bbe1fa;
      --md-sys-color-on-primary: #001b2e;
      --md-sys-color-primary-container: #0f4c75;
      --md-sys-color-on-primary-container: #bbe1fa;
      --md-sys-color-secondary: #90caf9;
      --md-sys-color-on-secondary: #001f2a;
      --md-sys-color-secondary-container: #1e3a5f;
      --md-sys-color-on-secondary-container: #d1ecf4;
      --md-sys-color-surface: #0e1419;
      --md-sys-color-on-surface: #e1e3e5;
      --md-sys-color-surface-variant: #3e484d;
      --md-sys-color-on-surface-variant: #bfc8cc;
      --md-sys-color-outline: #899297;
      --md-sys-color-outline-variant: #3e484d;
      --md-sys-color-error: #ffb4ab;
      --md-sys-color-on-error: #690005;
      --md-sys-color-error-container: #93000a;
      --md-sys-color-on-error-container: #ffdad6;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Roboto', sans-serif;
      background-color: var(--md-sys-color-surface);
      color: var(--md-sys-color-on-surface);
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    #app {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .loading {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      font-size: 1.2rem;
      color: var(--md-sys-color-on-surface-variant);
    }

    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid var(--md-sys-color-outline-variant);
      border-top: 4px solid var(--md-sys-color-primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-right: 16px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .loading {
        font-size: 1rem;
      }
      
      .spinner {
        width: 32px;
        height: 32px;
        margin-right: 12px;
      }
    }
  </style>
</head>
<body>
  <div id="app" role="application" aria-label="PolymerShop E-commerce Application">
    <!-- L'application Lit sera inject√©e ici -->
  </div>

  <!-- PolymerShop Fallback Application (Vanilla JS) -->
  <script type="module" src="/src/fallback-entry.js"></script>

  <!-- PWA Service Worker Registration -->
  <script>
    // Register service worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then((registration) => {
            console.log('‚úÖ Service Worker registered successfully:', registration.scope);

            // Check for updates
            registration.addEventListener('updatefound', () => {
              const newWorker = registration.installing;
              if (newWorker) {
                newWorker.addEventListener('statechange', () => {
                  if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                    // New version available
                    if (confirm('üöÄ New version available! Reload to update?')) {
                      window.location.reload();
                    }
                  }
                });
              }
            });

            // Handle messages from service worker
            navigator.serviceWorker.addEventListener('message', (event) => {
              if (event.data && event.data.type === 'CACHE_SIZE') {
                console.log('üíæ Cache size:', event.data.size);
              }
            });
          })
          .catch((error) => {
            console.error('‚ùå Service Worker registration failed:', error);
          });
      });
    }

    // PWA install prompt
    let deferredPrompt;

    window.addEventListener('beforeinstallprompt', (e) => {
      // Prevent the mini-infobar from appearing on mobile
      e.preventDefault();
      // Stash the event so it can be triggered later
      deferredPrompt = e;

      // Show install button
      showInstallButton();
    });

    function showInstallButton() {
      const installButton = document.createElement('button');
      installButton.id = 'pwa-install-btn';
      installButton.innerHTML = 'üì± Install App';
      installButton.style.cssText = `
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: linear-gradient(45deg, #2196f3, #1976d2);
        color: white;
        border: none;
        padding: 12px 20px;
        border-radius: 50px;
        cursor: pointer;
        font-weight: 600;
        box-shadow: 0 4px 20px rgba(33, 150, 243, 0.4);
        z-index: 1000;
        transition: all 0.3s ease;
      `;

      installButton.onclick = async () => {
        if (deferredPrompt) {
          deferredPrompt.prompt();
          const { outcome } = await deferredPrompt.userChoice;

          if (outcome === 'accepted') {
            console.log('‚úÖ User accepted the install prompt');
          } else {
            console.log('‚ùå User dismissed the install prompt');
          }

          deferredPrompt = null;
          installButton.remove();
        }
      };

      document.body.appendChild(installButton);

      // Auto-hide after 10 seconds
      setTimeout(() => {
        if (installButton.parentNode) {
          installButton.remove();
        }
      }, 10000);
    }

    // Handle app installed
    window.addEventListener('appinstalled', (e) => {
      console.log('üéâ PWA was installed');
      // Hide install button if it exists
      const installBtn = document.getElementById('pwa-install-btn');
      if (installBtn) {
        installBtn.remove();
      }
    });

    // Check if app is already installed
    if (window.matchMedia && window.matchMedia('(display-mode: standalone)').matches) {
      console.log('üì± App is running in standalone mode (PWA)');
    }

    // Network status detection
    let isOnline = navigator.onLine;
    function updateOnlineStatus() {
      const wasOnline = isOnline;
      isOnline = navigator.onLine;

      if (isOnline !== wasOnline) {
        if (isOnline) {
          console.log('üåê Back online');
          // Show success notification
          showNetworkNotification('‚úÖ Back online!', 'success');
        } else {
          console.log('üì¥ Gone offline');
          // Show warning notification
          showNetworkNotification('üì¥ You are offline', 'warning');
        }
      }
    }

    window.addEventListener('online', updateOnlineStatus);
    window.addEventListener('offline', updateOnlineStatus);

    function showNetworkNotification(message, type) {
      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        left: 20px;
        background: ${type === 'success' ? '#4caf50' : '#ff9800'};
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        z-index: 1000;
        font-weight: 500;
        animation: slideInFromLeft 0.4s ease-out;
      `;
      notification.textContent = message;

      document.body.appendChild(notification);

      setTimeout(() => {
        if (notification.parentNode) {
          notification.style.animation = 'slideOutToLeft 0.3s ease-in';
          setTimeout(() => notification.remove(), 300);
        }
      }, 3000);
    }

    // Add network notification styles
    const networkStyles = document.createElement('style');
    networkStyles.textContent = `
      @keyframes slideInFromLeft {
        from { transform: translateX(-100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }

      @keyframes slideOutToLeft {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(-100%); opacity: 0; }
      }
    `;
    document.head.appendChild(networkStyles);

    // Performance monitoring
    if ('performance' in window && 'PerformanceObserver' in window) {
      // Monitor Core Web Vitals
      try {
        const observer = new PerformanceObserver((list) => {
          for (const entry of list.getEntries()) {
            if (entry.entryType === 'measure') {
              console.log('üìä Performance:', entry.name, entry.duration + 'ms');
            }
          }
        });
        observer.observe({ entryTypes: ['measure'] });
      } catch (e) {
        console.log('‚ö†Ô∏è Performance monitoring not fully supported');
      }
    }

    // Mark performance
    window.addEventListener('load', () => {
      if ('performance' in window && 'mark' in performance) {
        performance.mark('app-loaded');
        console.log('üöÄ App loaded successfully');
      }
    });
  </script>




</body>
</html>
